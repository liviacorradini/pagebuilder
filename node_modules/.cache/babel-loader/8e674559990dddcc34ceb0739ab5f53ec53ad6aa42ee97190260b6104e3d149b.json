{"ast":null,"code":"require(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.array.unshift.js\");\n/*! grapesjs-script-editor - 1.0.3 */\n!function (t, e) {\n  'object' == typeof exports && 'object' == typeof module ? module.exports = e() : 'function' == typeof define && define.amd ? define([], e) : 'object' == typeof exports ? exports[\"grapesjs-script-editor\"] = e() : t[\"grapesjs-script-editor\"] = e();\n}(window, function () {\n  return function (t) {\n    var e = {};\n    function r(n) {\n      if (e[n]) return e[n].exports;\n      var o = e[n] = {\n        i: n,\n        l: !1,\n        exports: {}\n      };\n      return t[n].call(o.exports, o, o.exports, r), o.l = !0, o.exports;\n    }\n    return r.m = t, r.c = e, r.d = function (t, e, n) {\n      r.o(t, e) || Object.defineProperty(t, e, {\n        enumerable: !0,\n        get: n\n      });\n    }, r.r = function (t) {\n      'undefined' != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, {\n        value: 'Module'\n      }), Object.defineProperty(t, '__esModule', {\n        value: !0\n      });\n    }, r.t = function (t, e) {\n      if (1 & e && (t = r(t)), 8 & e) return t;\n      if (4 & e && 'object' == typeof t && t && t.__esModule) return t;\n      var n = Object.create(null);\n      if (r.r(n), Object.defineProperty(n, 'default', {\n        enumerable: !0,\n        value: t\n      }), 2 & e && 'string' != typeof t) for (var o in t) r.d(n, o, function (e) {\n        return t[e];\n      }.bind(null, o));\n      return n;\n    }, r.n = function (t) {\n      var e = t && t.__esModule ? function () {\n        return t.default;\n      } : function () {\n        return t;\n      };\n      return r.d(e, 'a', e), e;\n    }, r.o = function (t, e) {\n      return Object.prototype.hasOwnProperty.call(t, e);\n    }, r.p = \"\", r(r.s = 1);\n  }([function (t, e) {\n    t.exports = function (t, e, r) {\n      return e in t ? Object.defineProperty(t, e, {\n        value: r,\n        enumerable: !0,\n        configurable: !0,\n        writable: !0\n      }) : t[e] = r, t;\n    };\n  }, function (t, e, r) {\n    \"use strict\";\n\n    r.r(e);\n    var n = r(0),\n      o = r.n(n),\n      i = 'edit-script';\n    function c(t, e) {\n      var r = Object.keys(t);\n      if (Object.getOwnPropertySymbols) {\n        var n = Object.getOwnPropertySymbols(t);\n        e && (n = n.filter(function (e) {\n          return Object.getOwnPropertyDescriptor(t, e).enumerable;\n        })), r.push.apply(r, n);\n      }\n      return r;\n    }\n    function a(t) {\n      for (var e = 1; e < arguments.length; e++) {\n        var r = null != arguments[e] ? arguments[e] : {};\n        e % 2 ? c(Object(r), !0).forEach(function (e) {\n          o()(t, e, r[e]);\n        }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(r)) : c(Object(r)).forEach(function (e) {\n          Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(r, e));\n        });\n      }\n      return t;\n    }\n    var s = function (t) {\n      var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},\n        r = t.Commands,\n        n = t.Modal,\n        o = t.Components,\n        c = e.modalTitle,\n        s = e.codeViewOptions,\n        u = e.commandAttachScript,\n        l = e.toolbarIcon,\n        p = e.onRun,\n        d = e.onError,\n        f = e.starter,\n        b = e.scriptTypesSupport,\n        g = null,\n        h = function (t, e) {\n          e instanceof HTMLElement ? t.appendChild(e) : e && t.insertAdjacentHTML('beforeend', e);\n        };\n      t.$.isString(b) && (b = b.split(',')), t.$.isArray(b) && (b = b.includes('*') ? o.getTypes().map(function (t) {\n        return t.id;\n      }) : b), b && b.forEach(function (t) {\n        var r = o.getType(t).model;\n        o.addType(t, {\n          model: {\n            initToolbar: function () {\n              r.prototype.initToolbar.apply(this, arguments);\n              var t = this.get('toolbar'),\n                n = t.some(function (t) {\n                  return t.command === i;\n                });\n              n || (t.unshift(a({\n                command: i,\n                label: l\n              }, e.toolbarBtnCustomScript)), this.set('toolbar', t));\n            }\n          }\n        });\n      }), r.add(i, a({\n        run: function (t, e) {\n          var r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\n          this.editor = t, this.options = r, this.target = r.target || t.getSelected();\n          var n = this.target;\n          n && this.showCustomCode(n);\n        },\n        stop: function (t) {\n          n.close();\n        },\n        showCustomCode: function (t) {\n          var e = this,\n            r = this.editor,\n            o = this.options.title || c;\n          g || (g = this.getContent());\n          var i = t.getScriptString() || f;\n          n.open({\n            title: o,\n            content: g\n          }).getModel().once('change:open', function () {\n            return r.stopCommand(e.id);\n          }), this.getCodeViewer().setContent(i);\n        },\n        getPreContent: function () {},\n        getPostContent: function () {},\n        getContent: function () {\n          var t = this.editor,\n            e = document.createElement('div'),\n            r = t.getConfig('stylePrefix');\n          e.className = \"\".concat(r, \"attach-script\"), h(e, this.getPreContent());\n          var n = this.getCodeViewer();\n          return n.refresh(), setTimeout(function () {\n            return n.focus();\n          }, 0), e.appendChild(n.getElement()), h(e, this.getPostContent()), h(e, this.getContentActions()), e;\n        },\n        getContentActions: function () {\n          var t = this,\n            r = this.editor,\n            n = document.createElement('div');\n          n.id = \"actns\";\n          var o = document.createElement('button'),\n            i = r.getConfig('stylePrefix');\n          o.innerHTML = e.buttonLabel, o.className = \"\".concat(i, \"btn-prim \").concat(i, \"btn-save__inject-logic\"), o.onclick = function () {\n            return t.handleSave();\n          };\n          var c = document.createElement('div');\n          return c.id = \"logic-toolbar\", c.className = \"fa fa-bug\", c.style = \"margin:5px;padding:10px;background:rgba(0,0,0,0.2);border-radius:3px;border:1px solid rgba(0,0,0,0.2);cursor:pointer\", c.onclick = function () {\n            return t.runCode();\n          }, n.appendChild(c), n.appendChild(o), n;\n        },\n        handleSave: function () {\n          var t = this.editor,\n            e = this.target,\n            r = this.getCodeViewer().getContent();\n          e.set('script', r), t.Modal.close();\n        },\n        getCodeViewer: function () {\n          var t = this.editor;\n          return this.codeViewer || (this.codeViewer = t.CodeManager.createViewer(a({\n            codeName: 'javascript',\n            theme: 'hopscotch',\n            readOnly: 0,\n            autoBeautify: 1\n          }, s))), this.codeViewer;\n        },\n        runCode: function () {\n          try {\n            var t = this.getCodeViewer().getContent();\n            Function('\"use strict\";' + t)(), p && p();\n          } catch (t) {\n            console.log(\"error\", t), d && d(t);\n          }\n        }\n      }, u));\n    };\n    function u(t, e) {\n      var r = Object.keys(t);\n      if (Object.getOwnPropertySymbols) {\n        var n = Object.getOwnPropertySymbols(t);\n        e && (n = n.filter(function (e) {\n          return Object.getOwnPropertyDescriptor(t, e).enumerable;\n        })), r.push.apply(r, n);\n      }\n      return r;\n    }\n    function l(t) {\n      for (var e = 1; e < arguments.length; e++) {\n        var r = null != arguments[e] ? arguments[e] : {};\n        e % 2 ? u(Object(r), !0).forEach(function (e) {\n          o()(t, e, r[e]);\n        }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(r)) : u(Object(r)).forEach(function (e) {\n          Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(r, e));\n        });\n      }\n      return t;\n    }\n    e.default = function (t) {\n      var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},\n        r = l(l({}, {\n          starter: 'let el = this',\n          toolbarIcon: '<i class=\"fa fa-file-code-o\"></i>',\n          scriptTypesSupport: ['default', 'wrapper', 'text', 'textnode', 'image', 'video', 'svg'],\n          toolbarBtnCustomScript: {},\n          onRun: function () {\n            return console.log('valid syntax');\n          },\n          onError: function (t) {\n            return console.log('error', t);\n          },\n          modalTitle: 'Script',\n          codeLabel: 'JS',\n          codeViewOptions: {},\n          buttonLabel: 'Save',\n          commandAttachScript: {}\n        }), e);\n      s(t, r);\n    };\n  }]);\n});","map":{"version":3,"mappings":"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","names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","obj","configurable","writable","cmdId","editor","opts","arguments","cm","Commands","md","Modal","domc","Components","modalTitle","codeViewOptions","commandAttachScript","toolbarIcon","onRun","onError","starter","scriptTypesSupport","content","appendToContent","target","HTMLElement","appendChild","insertAdjacentHTML","$","isString","split","isArray","includes","getTypes","map","id","forEach","typeOpt","getType","type","model","addType","initToolbar","apply","this","tb","tbExists","some","item","command","unshift","a","label","toolbarBtnCustomScript","set","add","run","sender","options","getSelected","showCustomCode","stop","close","title","getContent","code","getScriptString","open","getModel","once","stopCommand","e","getCodeViewer","setContent","getPreContent","getPostContent","document","createElement","pfx","getConfig","className","codeViewer","refresh","setTimeout","focus","getElement","getContentActions","actions","btn","innerHTML","buttonLabel","onclick","handleSave","runLogic","style","runCode","CodeManager","createViewer","codeName","theme","readOnly","autoBeautify","Function","err","console","log","codeLabel","commands"],"sourceRoot":"","sources":["webpack://grapesjs-script-editor/webpack/universalModuleDefinition","webpack://grapesjs-script-editor/webpack/bootstrap","webpack://grapesjs-script-editor/node_modules/@babel/runtime/helpers/defineProperty.js","webpack://grapesjs-script-editor/src/consts.js","webpack://grapesjs-script-editor/src/commands.js","webpack://grapesjs-script-editor/src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"grapesjs-script-editor\"] = factory();\n\telse\n\t\troot[\"grapesjs-script-editor\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","export const cmdId = 'edit-script';","import {\r\n    cmdId\r\n} from './consts';\r\n\r\nexport default (editor, opts = {}) => {\r\n    const cm = editor.Commands;\r\n    const md = editor.Modal;\r\n    const domc = editor.Components;\r\n    const {\r\n        modalTitle,\r\n        codeViewOptions,\r\n        commandAttachScript,\r\n        toolbarIcon,\r\n        onRun,\r\n        onError,\r\n        starter\r\n    } = opts;\r\n    let scriptTypesSupport = opts.scriptTypesSupport;\r\n\r\n    let content = null;\r\n\r\n    const appendToContent = (target, content) => {\r\n        if (content instanceof HTMLElement) {\r\n            target.appendChild(content);\r\n        } else if (content) {\r\n            target.insertAdjacentHTML('beforeend', content);\r\n        }\r\n    };\r\n\r\n    if (editor.$.isString(scriptTypesSupport)) {\r\n        scriptTypesSupport = scriptTypesSupport.split(',');\r\n    }\r\n\r\n    if (editor.$.isArray(scriptTypesSupport)) {\r\n        scriptTypesSupport = scriptTypesSupport.includes('*') ?\r\n            domc.getTypes().map(c => c.id) : scriptTypesSupport;\r\n    }\r\n\r\n    // Add icons to specified component types\r\n    scriptTypesSupport && scriptTypesSupport.forEach(type => {\r\n        const typeOpt = domc.getType(type).model;\r\n        domc.addType(type, {\r\n            model: {\r\n                initToolbar() {\r\n                    typeOpt.prototype.initToolbar.apply(this, arguments);\r\n                    const tb = this.get('toolbar');\r\n                    const tbExists = tb.some(item => item.command === cmdId);\r\n\r\n                    if (!tbExists) {\r\n                        tb.unshift({\r\n                            command: cmdId,\r\n                            label: toolbarIcon,\r\n                            ...opts.toolbarBtnCustomScript\r\n                        });\r\n                        this.set('toolbar', tb);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    })\r\n\r\n    // Add the script command\r\n    cm.add(cmdId, {\r\n        run(editor, sender, opts = {}) {\r\n            this.editor = editor;\r\n            this.options = opts;\r\n            this.target = opts.target || editor.getSelected();\r\n            const target = this.target;\r\n\r\n            if (target) this.showCustomCode(target);\r\n        },\r\n\r\n        stop(editor) {\r\n            md.close();\r\n        },\r\n\r\n        /**\r\n         * Method which tells how to show the custom code\r\n         * @param  {Component} target\r\n         */\r\n        showCustomCode(target) {\r\n            const { editor, options } = this;\r\n            const title = options.title || modalTitle;\r\n            if (!content) content = this.getContent();\r\n            let code = target.getScriptString() || starter;\r\n            md.open({\r\n                title,\r\n                content\r\n            }).getModel().once('change:open', () => editor.stopCommand(this.id));\r\n            this.getCodeViewer().setContent(code);\r\n        },\r\n\r\n        /**\r\n         * Custom pre-content. Can be a simple string or an HTMLElement\r\n         */\r\n        getPreContent() {},\r\n\r\n        /**\r\n         * Custom post-content. Can be a simple string or an HTMLElement\r\n         */\r\n        getPostContent() {},\r\n\r\n        /**\r\n         * Get all the content for the custom code\r\n         * @return {HTMLElement}\r\n         */\r\n        getContent() {\r\n            const { editor } = this;\r\n            const content = document.createElement('div');\r\n            const pfx = editor.getConfig('stylePrefix');\r\n            content.className = `${pfx}attach-script`;\r\n            appendToContent(content, this.getPreContent());\r\n            const codeViewer = this.getCodeViewer();\r\n            codeViewer.refresh();\r\n            setTimeout(() => codeViewer.focus(), 0);\r\n            content.appendChild(codeViewer.getElement());\r\n            appendToContent(content, this.getPostContent());\r\n            appendToContent(content, this.getContentActions());\r\n\r\n            return content;\r\n        },\r\n\r\n        /**\r\n         * Get the actions content. Can be a simple string or an HTMLElement\r\n         * @return {HTMLElement|String}\r\n         */\r\n        getContentActions() {\r\n            const { editor } = this;\r\n            const actions = document.createElement('div');\r\n            actions.id = \"actns\";\r\n            const btn = document.createElement('button');\r\n            const pfx = editor.getConfig('stylePrefix');\r\n            btn.innerHTML = opts.buttonLabel;\r\n            btn.className = `${pfx}btn-prim ${pfx}btn-save__inject-logic`;\r\n            btn.onclick = () => this.handleSave();\r\n\r\n            const runLogic = document.createElement('div');\r\n            runLogic.id = \"logic-toolbar\";\r\n            runLogic.className = \"fa fa-bug\";\r\n            runLogic.style = \"margin:5px;padding:10px;background:rgba(0,0,0,0.2);border-radius:3px;border:1px solid rgba(0,0,0,0.2);cursor:pointer\";\r\n            runLogic.onclick = () => this.runCode();\r\n\r\n            actions.appendChild(runLogic);\r\n            actions.appendChild(btn);\r\n\r\n            return actions;\r\n        },\r\n\r\n        /**\r\n         * Handle the main save task\r\n         */\r\n        handleSave() {\r\n            const { editor, target } = this;\r\n            const code = this.getCodeViewer().getContent();\r\n            target.set('script', code);\r\n            editor.Modal.close();\r\n        },\r\n\r\n        /**\r\n         * Return the code viewer instance\r\n         * @return {CodeViewer}\r\n         */\r\n        getCodeViewer() {\r\n            const { editor } = this;\r\n\r\n            if (!this.codeViewer) {\r\n                this.codeViewer = editor.CodeManager.createViewer({\r\n                    codeName: 'javascript',\r\n                    theme: 'hopscotch',\r\n                    readOnly: 0,\r\n                    autoBeautify: 1,\r\n                    ...codeViewOptions,\r\n                });\r\n            }\r\n\r\n            return this.codeViewer;\r\n        },\r\n\r\n        /**\r\n         * Evaluate code syntax\r\n         */\r\n        runCode() {\r\n            //console.log(\"run\")\r\n            try {\r\n                const code = this.getCodeViewer().getContent();\r\n                Function('\"use strict\";' + code)(); // final code\r\n                onRun && onRun();\r\n            } catch (err) {\r\n                console.log(\"error\", err);\r\n                onError && onError(err);\r\n            }\r\n        },\r\n\r\n        ...commandAttachScript,\r\n    });\r\n}","import commands from './commands';\n\nexport default (editor, opts = {}) => {\n    const options = {\n        ...{\n            // Starter code\n            starter: 'let el = this',\n\n            toolbarIcon: '<i class=\"fa fa-file-code-o\"></i>',\n\n            // Component types to allow script editing\n            // Avoid components with predefined scripts\n            scriptTypesSupport: ['default', 'wrapper', 'text', 'textnode', 'image', 'video', 'svg'],\n\n            // Object to extend the default component's toolbar button for the code, eg. `{ label: '</>', attributes: { title: 'Open custom code' } }`\n            // Pass a falsy value to avoid adding the button\n            toolbarBtnCustomScript: {},\n\n            // On run success\n            onRun: () => console.log('valid syntax'),\n\n            // Logic when there is an error on run\n            onError: err => console.log('error', err),\n\n            // Title for the custom code modal\n            modalTitle: 'Script',\n\n            // Textarea label\n            codeLabel: 'JS',\n\n            // Additional options for the code viewer, eg. `{ theme: 'hopscotch', readOnly: 0 }`\n            codeViewOptions: {},\n\n            // Label for the default save button\n            buttonLabel: 'Save',\n\n            // Object to extend the default inject logic command.\n            // Check the source to see all available methods\n            commandAttachScript: {},\n        },\n        ...opts\n    };\n\n    // load commands\n    commands(editor, options);\n};"]},"metadata":{},"sourceType":"script","externalDependencies":[]}