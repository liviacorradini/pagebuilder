{"version":3,"file":"index.js","mappings":"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","sources":["webpack://cubo-form/webpack/universalModuleDefinition","webpack://cubo-form/webpack/bootstrap","webpack://cubo-form/webpack/runtime/define property getters","webpack://cubo-form/webpack/runtime/hasOwnProperty shorthand","webpack://cubo-form/webpack/runtime/make namespace object","webpack://cubo-form/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://cubo-form/./src/components.js","webpack://cubo-form/./src/blocks.js","webpack://cubo-form/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cubo-form\"] = factory();\n\telse\n\t\troot[\"cubo-form\"] = factory();\n})(typeof globalThis !== 'undefined' ? globalThis : (typeof window !== 'undefined' ? window : this), () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default (editor, opts = {}) => {\n  const domc = editor.DomComponents\n  const pipes = opts.pipes ?? []\n  const customfields = opts.customfields ?? []\n\n  domc.addType('cubosuite-button', {\n    model: {\n      defaults: {\n        tagName: 'button',\n        droppable: false,\n        attributes: { type: 'submit' },\n        components: [{ tagName: 'span', components: 'Enviar' }],\n      },\n    },\n    view: {},\n  })\n\n  const script = function (props) {\n\n    VMasker(document.querySelector(\"[name='phone']\")).maskPattern('(99) 99999-9999')\n\n    this.addEventListener('submit', (event) => {\n      event.preventDefault()\n      event.target.setAttribute('disable', true)\n\n      if (!props.pipe || !props.keycubo) {\n        alert('API KEY ou Funil não selecionados.')\n      }\n\n      let form = this\n      let pristine = new Pristine(this)\n      let valid = pristine.validate()\n\n      if (valid) {\n        let fields = form.querySelectorAll('input, select')\n\n        let payload = {\n          title: form.querySelector(\"[name='name']\").value,\n          peopleName: form.querySelector(\"[name='name']\").value,\n          peoplePhone: form.querySelector(\"[name='phone']\").value,\n          pipeId: props.pipe,\n          customfields: []\n        }\n\n        const utms = [\n          'UTM Source',\n          'UTM Medium',\n          'UTM Campaign',\n          'UTM Term',\n          'UTM Content',\n        ]\n\n        fields.forEach((field) => {\n          let type = field.getAttribute('type')\n          let name = field.getAttribute('name')\n          let customfieldName = field.getAttribute('data-cf')\n\n          if (name !== 'name' && name !== 'phone') {\n            if (type === 'text' || type === 'email') {\n\n              const name = customfieldName.toLowerCase().split(' ').join('_')\n              const queryString = window.location.search\n              const urlParams = new URLSearchParams(queryString)\n              if(!field.value) field.value = urlParams.get(name) ? urlParams.get(name) : null\n              // if( utms.some(utm => utm.toLowerCase() === customfieldName.toLowerCase() )){\n              // }\n\n              if (field.value) {\n                payload.customfields.push({\n                  customfieldId: parseInt(field.getAttribute('name')),\n                  value: field.value,\n                })\n              }\n            }\n            if (type === 'select') {\n              if (field.options[field.selectedIndex].value) {\n                payload.customfields.push({\n                  customfieldId: parseInt(field.getAttribute('name')),\n                  value: field.options[field.selectedIndex].value,\n                })\n              }\n            }\n          }\n        })\n\n        payload.customfields = payload.customfields.filter(cf => cf.value)\n\n        fetch('https://api.cubosuite.com.br/deals/external?asyncRequest=true', {\n          method: 'POST',\n          headers: {\n            'Content-type' : 'application/json',\n            'Authorization' : `Bearer ${props.keycubo}`\n          },\n          body: JSON.stringify(payload)\n        })\n        .then(response => response.json())\n        .then(response => {\n          event.target.setAttribute('disable', false)\n          if (props.redirect) {\n            window.location.href = props.redirect\n          }\n        })\n      }\n    })\n  }\n\n  domc.addType('cubosuite-form', {\n    model: {\n      defaults: {\n        'tagName': 'form',\n        'droppable': false,\n        'attributes': { method: 'POST' },\n        'traits': [\n          { label: 'Api key', type: 'text', name: 'keycubo', changeProp: true },\n          {\n            label: 'Funíl',\n            type: 'select',\n            name: 'pipe',\n            changeProp: true,\n            options: pipes,\n          },\n          {\n            label: 'Redirecionar para',\n            type: 'text',\n            name: 'redirect',\n            changeProp: true,\n          },\n        ],\n\n        'pipe': '',\n        'keycubo': '',\n        'redirect': '',\n\n        script,\n\n        'script-props': ['pipe', 'keycubo', 'redirect', 'button'],\n\n        'components': (model) => {\n          let inputs = `\n          <div class=\"form-group\">\n            <label class=\"label\">Nome</label>\n            <input placeholder=\"Insira o nome\" type=\"text\" name=\"name\" required class=\"form-control\"/>\n          </div>\n          <div class=\"form-group\">\n            <label class=\"label\">Telefone</label>\n            <input placeholder=\"Insira o telefone\" type=\"text\" required name=\"phone\" class=\"form-control\"/>\n          </div>\n          `\n\n          customfields.forEach((cf) => {\n            let field = ``\n            if (cf.type === 'text') {\n              field = `\n              <div class=\"form-group\">\n                <label class=\"label\">${cf.name}</label>\n                <input placeholder=\"Insira o ${cf.name}\"  type=\"text\" name=\"${cf.id}\" class=\"form-control\" data-cf=\"${cf.name}\"/>\n              </div>`\n            }\n\n            if (cf.type === 'selectbox') {\n              let options = `<option selected disabled value=''>Selecione um ${cf.name}</option>`\n\n              cf.options.forEach((opt) => {\n                options += `<option value=\"${opt.value}\">${opt.value}</option>`\n              })\n\n              field = `\n              <div class=\"form-group\">\n                <label class=\"label\">${cf.name}</label>\n                <select name=\"${cf.id}\" type=\"select\" class=\"form-control\" data-cf=\"${cf.name}\">\n                ${options}\n                </select>\n              </div>`\n            }\n\n            inputs += field\n          })\n\n          inputs += `<button data-gjs-type=\"cubosuite-button\" class=\"btn btn-primary\"><span>Enviar</span></button>`\n          \n          return inputs\n        },\n      },\n    },\n    view: {},\n  })\n}\n","export default (editor, opts = {}) => {\n  const bm = editor.BlockManager\n\n  bm.add('cubosuite-form', {\n    label: 'Formulário Cubo Suite',\n    content: { type: 'cubosuite-form' },\n    category: 'Forms',\n    media: `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <svg id=\"Camada_2\" data-name=\"Camada 2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 128.18 144.05\">\n      <defs>\n        <style>\n          .cls-1 {\n            fill: #fff;\n          }\n        </style>\n      </defs>\n      <g id=\"Camada_1-2\" data-name=\"Camada 1\">\n        <g>\n          <path class=\"cls-1\" d=\"M64.09,144.05c-2.21,0-4.41-.57-6.38-1.7L6.38,112.71c-3.93-2.27-6.38-6.5-6.38-11.05V42.39c0-4.54,2.44-8.77,6.38-11.05L57.71,1.7c3.93-2.27,8.82-2.27,12.75,0l51.33,29.64c3.93,2.27,6.38,6.5,6.38,11.05v59.28c0,4.54-2.44,8.77-6.38,11.05l-51.33,29.64c-1.97,1.14-4.17,1.7-6.38,1.7Zm0-138.72c-1.28,0-2.57,.33-3.71,.99L9.04,35.95c-2.29,1.32-3.71,3.79-3.71,6.43v59.28c0,2.64,1.42,5.11,3.71,6.43l51.33,29.64c2.29,1.32,5.14,1.32,7.43,0l51.33-29.64c2.29-1.32,3.71-3.79,3.71-6.43V42.39c0-2.64-1.42-5.11-3.71-6.43L67.8,6.32c-1.15-.66-2.43-.99-3.71-.99Z\"/>\n          <path class=\"cls-1\" d=\"M64.14,124.2h0c-1.47,0-2.66-1.19-2.66-2.66v-51.56c0-1.07-.64-2.03-1.62-2.45L22.03,51.43c-1.35-.58-1.98-2.14-1.41-3.49h0c.58-1.35,2.14-1.98,3.49-1.41l38.99,16.6c.66,.28,1.42,.28,2.08,0l39.29-16.61c1.35-.57,2.92,.06,3.49,1.42h0c.57,1.36-.06,2.92-1.42,3.49l-38.12,16.11c-.99,.42-1.63,1.38-1.63,2.45v51.55c0,1.47-1.19,2.66-2.66,2.66Z\"/>\n        </g>\n      </g>\n    </svg> \n    `,\n  })\n}\n","import loadComponents from './components'\nimport loadBlocks from './blocks'\n\nexport default (editor, opts = {}) => {\n  const options = {\n    ...{\n      // default options\n    },\n    ...opts,\n  }\n\n  // Add components\n  loadComponents(editor, options)\n  // Add blocks\n  loadBlocks(editor, options)\n}\n"],"names":["root","factory","exports","module","define","amd","globalThis","window","this","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_defineProperty","configurable","writable","editor","opts","domc","DomComponents","pipes","customfields","addType","model","defaults","tagName","droppable","attributes","type","components","view","script","props","VMasker","document","querySelector","maskPattern","addEventListener","event","preventDefault","target","setAttribute","pipe","keycubo","alert","form","Pristine","validate","fields","querySelectorAll","payload","title","peopleName","peoplePhone","pipeId","forEach","field","getAttribute","name","customfieldName","toLowerCase","split","join","queryString","location","search","urlParams","URLSearchParams","push","customfieldId","parseInt","options","selectedIndex","filter","cf","fetch","method","headers","body","JSON","stringify","then","response","json","redirect","href","label","changeProp","inputs","id","opt","bm","BlockManager","add","content","category","media","loadComponents","loadBlocks"],"sourceRoot":""}